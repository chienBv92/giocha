
@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_LayoutAdmin.cshtml";
}

@{
    ViewBag.Title = "Quản trị hệ thống";
    Layout = "~/Views/Shared/_LayoutAdmin.cshtml";
    var currentUser = HttpContext.Current.Session["CmnEntityModel"] as Web_Gio_Cha.Models.CmnEntityModel;
    var tempDateTime = new DateTime();
}

<body onload="display_ct()">
    <div class="TrangchuAdmin">
        <h1 style="color:red">Quản trị hệ thống</h1>
        <div>Thời gian hiện tại: <span id='thisTime'></span> </div>
    </div>

    <div id="notice">
        <span class="showNotice noti glyphicon glyphicon-bell"><span class="count">&nbsp;</span></span>
        <div class="noti-content">
            <div class="noti-top-arrow"></div>
            <ul id="notiContent"></ul>
        </div>
    </div>
</body>

<style>
    .TrangchuAdmin {
        margin: 40px 20px;
    }

    .noti-content {
        position: fixed;
        right: 100px;
        background: #e5e5e5;
        border-radius: 4px;
        top: 47px;
        width: 250px;
        display: none;
        border: 1px solid #9E988B;
    }

    ul#notiContent {
        max-height: 200px;
        overflow: auto;
        padding: 0px;
        margin: 0px;
        padding-left: 20px;
    }

        ul#notiContent li {
            margin: 3px;
            padding: 6px;
            background: #fff;
        }

    .noti-top-arrow {
        border-color: transparent;
        border-bottom-color: #F5DEB3;
        border-style: dashed dashed solid;
        border-width: 0 8.5px 8.5px;
        position: absolute;
        right: 32px;
        top: -8px;
    }

    span.noti {
        color: #FF2323;
        margin: 15px;
        position: fixed;
        right: 100px;
        font-size: 18px;
        cursor: pointer;
    }

    span.count {
        position: relative;
        top: -3px;
    }
</style>
<script type="text/javascript">
    var checkTimeOutUrl = '@Url.Action("CheckTimeOut", "Common")';

    function display_c() {
        var refresh = 1000; // Refresh rate in milli seconds
        mytime = setTimeout('display_ct()', refresh)
    }

    function display_ct() {
        var strcount;
        var date = new Date();
        //document.getElementById('ct').innerHTML = x;
        //tt = display_c();
        var h = date.getHours();
        var m = date.getMinutes();
        var s = date.getSeconds();
        var datetime = h + ":" + m + ":" + s;
        //add a zero in front of numbers < 10

        //m = checkTime(m);
        //s = checkTime(s);
        $('#thisTime').text(datetime);
        tt = display_c();
    }

    $(function () {
        // Click on notification icon for show notification
        //$('span.noti').click(function (e) {
        //    e.stopPropagation();
        //    $('.noti-content').show();
        //    var count = 0;
        //    count = parseInt($('span.count').html()) || 0;
        //    //only load notification if not already loaded
        //    if (count > 0) {
        //        updateNotification();
        //    }
        //    $('span.count', this).html('&nbsp;');
        //})
        //// hide notifications
        //$('html').click(function () {
        //    $('.noti-content').hide();
        //})
        //// update notification
        //function updateNotification() {
        //    $('#notiContent').empty();
        //    $('#notiContent').append($('<li>Loading...</li>'));
        //    $.ajax({
        //        type: 'GET',
        //        url: '/home/GetNotificationContacts',
        //        success: function (response) {
        //            $('#notiContent').empty();
        //            if (response.length == 0) {
        //                $('#notiContent').append($('<li>No data available</li>'));
        //            }
        //            $.each(response, function (index, value) {
        //                $('#notiContent').append($('<li>New contact : ' + value.ContactName + ' (' + value.ContactNo + ') added</li>'));
        //            });
        //        },
        //        error: function (error) {
        //            console.log(error);
        //        }
        //    })
        //}
        // update notification count
        //function updateNotificationCount() {
        //    var count = 0;
        //    count = parseInt($('span.count').html()) || 0;
        //    count++;
        //    $('span.count').html(count);
        //}
        // signalr js code for start hub and send receive notification
        //var notificationHub = $.connection.notificationHub;
        //$.connection.hub.start().done(function () {
        //    console.log('Notification hub started');
        //});
        ////signalr method for push server message to client
        //notificationHub.client.notify = function (message) {
        //    if (message && message.toLowerCase() == "added") {
        //        updateNotificationCount();
        //    }
        //}
    })

    @*setInterval(
       function ()
       {
           $.post("@Url.Action("Method", "Home")", {}, function (data) {
               alert(data);
           });
       }, 5000)*@

    //var i = 0;
    //var id = setInterval(myAlert, 1000);
    //function myAlert() {
    //    var date = new Date();
    //    var h = date.getHours();
    //    var m = date.getMinutes();
    //    var s = date.getSeconds();
    //    if (s == 30) {
    //        i++;
    //        alert("Hi " + i);
    //        if (i == 5)
    //            clearInterval(id);
    //    }
    //}

    //
    //var Now = new Date();
    //var nowDate = $.datepicker.formatDate("dd/mm/yy", new Date());
    //var fromDate = new Date(Now.getFullYear(), Now.getMonth(), Now.getDate() - 15);
    //var fromDateText = $.datepicker.formatDate("dd/mm/yy", new Date(Now.getFullYear(), Now.getMonth(), Now.getDate() - 15));

    //var _second = 1000;
    //var _minute = _second * 60;
    //var _hour = _minute * 60;
    //var _day = _hour * 24;
    //var timer;

    //function showRemaining() {
    //    var now = new Date();
    //    var distance = end - now;
    //    if (distance > 0) {
    //        clearInterval(timer);
    //        document.getElementById('countdown').innerHTML = 'EXPIRED!';
    //        window.location.href = '/Home/Index';

    //        return;
    //    }
    //    var days = Math.floor(distance / _day);
    //    var hours = Math.floor((distance % _day) / _hour);
    //    var minutes = Math.floor((distance % _hour) / _minute);
    //    var seconds = Math.floor((distance % _minute) / _second);


    //    document.getElementById('countdown').innerHTML = hours + 'hrs ';
    //    document.getElementById('countdown').innerHTML += minutes + 'mins ';
    //    document.getElementById('countdown').innerHTML += seconds + 'secs';
    //}

    //timer = setInterval(showRemaining, 1000);

    // Click view Status History
    $(document).off('.showNotice');
    $(document).on('click', '.showNotice', function () {
        var result = WebDuhoc.utility.getDataByAjax(checkTimeOutUrl, null);
        if (!result) {
            return false;
        }

        $(this).blur();

        var urlGetNotification = '@Url.Action("PopupGetNotification", "OrderShip")';
        //var param = {
        //    OrderId: OrderId,
        //    oldStatus: oldStatus
        //};
        WebDuhoc.utility.ShowPopup(urlGetNotification, null);
    });

</script>

